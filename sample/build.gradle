buildscript {
    repositories {
        mavenCentral()
        maven {
            url "https://oss.sonatype.org/content/repositories/snapshots/"
        }
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:0.7.+'
//        classpath 'com.novoda:gradle-android-command-plugin:1.0'
    }
}
apply plugin: 'android'
apply plugin: 'android-command'

repositories {
    mavenCentral()
}

android {
    compileSdkVersion 18
    buildToolsVersion "18.0.1"

    defaultConfig {
        minSdkVersion 7
        targetSdkVersion 16
    }

    buildTypes {
        debug {}
        release {}
        QA {}
    }

    productFlavors {

        flavorGroups "pricing", "releaseType"

        beta {
            flavorGroup "releaseType"
        }

        normal {
            flavorGroup "releaseType"
        }

        free {
            flavorGroup "pricing"
        }

        paid {
            flavorGroup "pricing"
        }
    }
}

dependencies {
    compile 'com.android.support:appcompat-v7:18.0.0'
}

def hudlDeviceId() {
    def hudlDevices = variant.attachedDevicesWithBrand('hudl')
    if (!hudlDevices) {
        throw new IllegalStateException("No hudl devices found")
    }
    hudlDevices[0]
}

def readLocalProperties() {
    def properties = new Properties()
    properties.load(project.rootProject.file("local.properties").newDataInputStream())
    properties.getProperty('sdk.dir') ?: variant.androidHome
}

variant {
    androidHome readLocalProperties()
}

variant.tasks "instHudl", com.novoda.gradle.command.Install, {
    deviceId "${-> hudlDeviceId()}"
}

variant.tasks "run", com.novoda.gradle.command.Run

variant.tasks "monkey", com.novoda.gradle.command.Monkey, {
    events 200
}

variant.tasks "clearPrefs", com.novoda.gradle.command.ClearPreferences
